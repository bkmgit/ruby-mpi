language: ruby
os:
 - linux
 - osx
rvm:
 - 2.0.0
 - 1.9.3
 - jruby-19mode
 - rbx-2
addons:
 apt:
  packages:
   - libopenmpi-dev
   - openmpi-bin
before_install:
 - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
 - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install open-mpi; fi
before_script:
 - bundle install
 - bundle exec rake compile
env:
 - JRUBY_OPTS=-Xcext.enabled=true
script:
 - bundle exec mpirun -n 2 rspec
